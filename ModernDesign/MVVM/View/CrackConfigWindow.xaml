<Window x:Class="ModernDesign.MVVM.View.CrackConfigWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Crack Configuration"
        Height="700" Width="750"
        MinHeight="600" MinWidth="700"
        WindowStyle="None"
        ResizeMode="CanResize"
        AllowsTransparency="True"
        Background="Transparent"
        WindowStartupLocation="CenterScreen"
        MouseLeftButtonDown="Window_MouseLeftButtonDown"
        Icon="/Icono_TLK.ico">

    <Window.Resources>
        <!-- Estilo para ComboBox -->
        <Style x:Key="ModernComboBox" TargetType="ComboBox">
            <Setter Property="Background" Value="#1a1a1a"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#1E5A8E"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <ToggleButton x:Name="ToggleButton"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        Focusable="False"
                                        IsChecked="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                        ClickMode="Press">
                                <ToggleButton.Template>
                                    <ControlTemplate TargetType="ToggleButton">
                                        <Border Background="{TemplateBinding Background}"
                                              BorderBrush="{TemplateBinding BorderBrush}"
                                              BorderThickness="{TemplateBinding BorderThickness}"
                                              CornerRadius="5">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition/>
                                                    <ColumnDefinition Width="30"/>
                                                </Grid.ColumnDefinitions>
                                                <ContentPresenter Grid.Column="0" Margin="10,0,0,0" VerticalAlignment="Center"/>
                                                <Path Grid.Column="1" Data="M 0 0 L 4 4 L 8 0 Z" 
                                                    Fill="#1E5A8E" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                    </ControlTemplate>
                                </ToggleButton.Template>
                            </ToggleButton>
                            <ContentPresenter x:Name="ContentSite"
                                            Content="{TemplateBinding SelectionBoxItem}"
                                            ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                            ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                            Margin="10,0,30,0"
                                            VerticalAlignment="Center"
                                            HorizontalAlignment="Left"
                                            IsHitTestVisible="False"/>
                            <Popup x:Name="Popup"
                                 Placement="Bottom"
                                 IsOpen="{TemplateBinding IsDropDownOpen}"
                                 AllowsTransparency="True"
                                 Focusable="False"
                                 PopupAnimation="Slide">
                                <Grid MinWidth="{TemplateBinding ActualWidth}" MaxHeight="200">
                                    <Border Background="#0d0d0d" BorderBrush="#1E5A8E" BorderThickness="2" CornerRadius="5">
                                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                                            <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained"/>
                                        </ScrollViewer>
                                    </Border>
                                </Grid>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Estilo para ComboBoxItem -->
        <Style TargetType="ComboBoxItem">
            <Setter Property="Background" Value="#0d0d0d"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBoxItem">
                        <Border Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                            <ContentPresenter/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter Property="Background" Value="#1E5A8E"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="#2563EB"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Border CornerRadius="12" BorderThickness="2" BorderBrush="#1E5A8E">
        <Border.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#0a0a0a" Offset="0"/>
                <GradientStop Color="#001a2e" Offset="1"/>
            </LinearGradientBrush>
        </Border.Background>
        <Border.Effect>
            <DropShadowEffect Color="#1E5A8E" BlurRadius="30" ShadowDepth="0" Opacity="0.6"/>
        </Border.Effect>

        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <StackPanel Grid.Row="0" Margin="0,0,0,20">
                <TextBlock x:Name="HeaderText" Text="⚙️ CRACK CONFIGURATION ⚙️"
                         FontSize="24" FontWeight="Bold" 
                         Foreground="#1E5A8E" HorizontalAlignment="Center"
                         FontFamily="Consolas">
                    <TextBlock.Effect>
                        <DropShadowEffect Color="#1E5A8E" BlurRadius="15" ShadowDepth="0" Opacity="0.8"/>
                    </TextBlock.Effect>
                </TextBlock>
                <TextBlock x:Name="SubHeaderText" Text="Configure your cracked game settings"
                         FontSize="11" Foreground="#888888" 
                         HorizontalAlignment="Center" Margin="0,5,0,0"
                         FontFamily="Consolas"/>
            </StackPanel>

            <!-- Content -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="10">
                    <!-- GAME SECTION -->
                    <Border Background="#0d0d0d" CornerRadius="8" Padding="15" Margin="0,0,0,15"
                            BorderBrush="#1E5A8E" BorderThickness="1">
                        <StackPanel>
                            <TextBlock Text="🎮 GAME SETTINGS" FontSize="16" FontWeight="Bold"
                                     Foreground="#1E5A8E" Margin="0,0,0,10" FontFamily="Consolas"/>

                            <!-- Version -->
                            <TextBlock Text="Game Version:" Foreground="#888888" FontSize="11" 
                                     Margin="0,5,0,3" FontFamily="Consolas"/>
                            <Grid ToolTip="Current game version. Click 'Auto-Detect' to fetch the latest version from GitHub.">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="VersionTextBox" Height="30" FontFamily="Consolas"
                                       Background="#1a1a1a" Foreground="White" BorderBrush="#1E5A8E"
                                       Padding="8,5" Grid.Column="0"/>
                                <Button x:Name="AutoDetectVersionBtn" Content="🔍 Auto-Detect" 
                                      Width="120" Height="30" Grid.Column="1" Margin="5,0,0,0"
                                      Background="#1E5A8E" Foreground="White" BorderThickness="0"
                                      Click="AutoDetectVersion_Click" Cursor="Hand" FontFamily="Consolas"
                                      ToolTip="Fetch latest game version from GitHub"/>
                            </Grid>

                            <!-- Language -->
                            <TextBlock Text="Language:" Foreground="#888888" FontSize="11" 
                                     Margin="0,10,0,3" FontFamily="Consolas"/>
                            <ComboBox x:Name="LanguageComboBox" Height="35" 
                                    Style="{StaticResource ModernComboBox}"
                                    ToolTip="Select the in-game language. This changes all text and audio in the game.">
                                <ComboBoxItem Content="English (en_US)" Tag="en_US"/>
                                <ComboBoxItem Content="Español (es_ES)" Tag="es_ES"/>
                                <ComboBoxItem Content="Français (fr_FR)" Tag="fr_FR"/>
                                <ComboBoxItem Content="Deutsch (de_DE)" Tag="de_DE"/>
                                <ComboBoxItem Content="Italiano (it_IT)" Tag="it_IT"/>
                                <ComboBoxItem Content="Português (pt_BR)" Tag="pt_BR"/>
                                <ComboBoxItem Content="日本語 (ja_JP)" Tag="ja_JP"/>
                                <ComboBoxItem Content="한국어 (ko_KR)" Tag="ko_KR"/>
                                <ComboBoxItem Content="中文简体 (zh_CN)" Tag="zh_CN"/>
                                <ComboBoxItem Content="中文繁體 (zh_TW)" Tag="zh_TW"/>
                                <ComboBoxItem Content="Русский (ru_RU)" Tag="ru_RU"/>
                                <ComboBoxItem Content="Polski (pl_PL)" Tag="pl_PL"/>
                                <ComboBoxItem Content="Nederlands (nl_NL)" Tag="nl_NL"/>
                                <ComboBoxItem Content="Svenska (sv_SE)" Tag="sv_SE"/>
                                <ComboBoxItem Content="Norsk (no_NO)" Tag="no_NO"/>
                                <ComboBoxItem Content="Suomi (fi_FI)" Tag="fi_FI"/>
                                <ComboBoxItem Content="Dansk (da_DK)" Tag="da_DK"/>
                                <ComboBoxItem Content="Čeština (cs_CZ)" Tag="cs_CZ"/>
                            </ComboBox>

                            <!-- Language Registry Spoof -->
                            <CheckBox x:Name="LanguageRegistrySpoofCheckBox" Content="Language Registry Spoof"
                                    Foreground="#888888" Margin="0,10,0,0" FontFamily="Consolas"
                                    ToolTip="Enable to change language without modifying Windows registry. Recommended: ON"/>
                        </StackPanel>
                    </Border>

                    <!-- EMULATOR SECTION -->
                    <Border Background="#0d0d0d" CornerRadius="8" Padding="15" Margin="0,0,0,15"
                            BorderBrush="#1E5A8E" BorderThickness="1">
                        <StackPanel>
                            <TextBlock Text="🔧 EMULATOR SETTINGS" FontSize="16" FontWeight="Bold"
                                     Foreground="#1E5A8E" Margin="0,0,0,10" FontFamily="Consolas"/>

                            <!-- FakeAuth -->
                            <CheckBox x:Name="FakeAuthCheckBox" Content="Enable Fake Authentication"
                                    Foreground="#888888" Margin="0,5,0,0" FontFamily="Consolas"
                                    ToolTip="Simulates online authentication. Only enable if you have connection issues."/>

                            <!-- LoadExtraDLLs -->
                            <CheckBox x:Name="LoadExtraDLLsCheckBox" Content="Load Extra DLLs (Version Checker)"
                                    Foreground="#888888" Margin="0,10,0,0" FontFamily="Consolas" IsChecked="True"
                                    ToolTip="⚠️ DISABLE ONLY if the game won't start. WARNING: Disabling this will skip version checking and you won't be notified of new updates!"/>

                            <!-- Custom Documents Folder -->
                            <CheckBox x:Name="CustomDocumentsCheckBox" Content="Enable Custom Documents Folder"
        Foreground="#888888" Margin="0,10,0,0" FontFamily="Consolas"
        ToolTip="⚠️ ADVANCED: Override default Documents location. Only enable if you know what you're doing!"
        Checked="CustomDocumentsCheckBox_Checked"
        Unchecked="CustomDocumentsCheckBox_Unchecked"/>

                            <Grid x:Name="CustomDocumentsPanel" Margin="10,5,0,0" Visibility="Collapsed"
      ToolTip="Custom path for Documents folder (mods, saves, tray files, screenshots, etc.)">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="CustomDocumentsTextBox" Height="30" FontFamily="Consolas"
           Background="#1a1a1a" Foreground="White" BorderBrush="#1E5A8E"
           Padding="8,5" Grid.Column="0" IsReadOnly="True"/>
                                <Button Content="📂" Width="40" Height="30" Grid.Column="1" Margin="5,0,0,0"
          Background="#1a1a1a" Foreground="#1E5A8E" BorderBrush="#1E5A8E"
          Click="BrowseCustomDocuments_Click" Cursor="Hand"
          ToolTip="Browse for custom Documents folder"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- USER SECTION -->
                    <Border Background="#0d0d0d" CornerRadius="8" Padding="15" Margin="0,0,0,15"
                            BorderBrush="#1E5A8E" BorderThickness="1">
                        <StackPanel>
                            <TextBlock Text="👤 USER PROFILE" FontSize="16" FontWeight="Bold"
                                     Foreground="#1E5A8E" Margin="0,0,0,10" FontFamily="Consolas"/>

                            <!-- Username -->
                            <TextBlock Text="Username:" Foreground="#888888" FontSize="11" 
                                     Margin="0,5,0,3" FontFamily="Consolas"/>
                            <TextBox x:Name="UsernameTextBox" Height="30" FontFamily="Consolas"
                                   Background="#1a1a1a" Foreground="White" BorderBrush="#1E5A8E"
                                   Padding="8,5"
                                   ToolTip="Your in-game username. This appears in your save files and gallery uploads."/>

                            <!-- PersonaId (BLOQUEADO) -->
                            <TextBlock Text="Persona ID:" Foreground="#888888" FontSize="11" 
                                     Margin="0,10,0,3" FontFamily="Consolas"/>
                            <TextBox x:Name="PersonaIdTextBox" Height="30" FontFamily="Consolas"
                                   Background="#2a2a2a" Foreground="#666666" BorderBrush="#444444"
                                   Padding="8,5" IsReadOnly="True"
                                   ToolTip="🔒 LOCKED - Unique identifier for your profile. Cannot be changed to prevent save corruption!"/>

                            <!-- UserId (BLOQUEADO) -->
                            <TextBlock Text="User ID:" Foreground="#888888" FontSize="11" 
                                     Margin="0,10,0,3" FontFamily="Consolas"/>
                            <TextBox x:Name="UserIdTextBox" Height="30" FontFamily="Consolas"
                                   Background="#2a2a2a" Foreground="#666666" BorderBrush="#444444"
                                   Padding="8,5" IsReadOnly="True"
                                   ToolTip="🔒 LOCKED - Your unique user ID. Cannot be changed to prevent save corruption!"/>

                            <!-- Avatar Path -->
                            <TextBlock Text="Avatar Path:" Foreground="#888888" FontSize="11" 
                                     Margin="0,10,0,3" FontFamily="Consolas"/>
                            <Grid ToolTip="Path to your custom avatar image (PNG recommended). Relative to Game-cracked/Bin folder.">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="AvatarPathTextBox" Height="30" FontFamily="Consolas"
                                       Background="#1a1a1a" Foreground="White" BorderBrush="#1E5A8E"
                                       Padding="8,5" Grid.Column="0"/>
                                <Button Content="📂" Width="40" Height="30" Grid.Column="1" Margin="5,0,0,0"
                                      Background="#1a1a1a" Foreground="#1E5A8E" BorderBrush="#1E5A8E"
                                      Click="BrowseAvatar_Click" Cursor="Hand"
                                      ToolTip="Browse for custom avatar image"/>
                            </Grid>

                            <!-- Use Last Online Profile -->
                            <CheckBox x:Name="UseLastOnlineProfileCheckBox" Content="Use Last Online Profile"
                                    Foreground="#888888" Margin="0,10,0,0" FontFamily="Consolas"
                                    ToolTip="When enabled, uses your legitimate EA profile data instead of custom values above. Disable for full offline mode."/>
                        </StackPanel>
                    </Border>

                    <!-- ENTITLEMENTS SECTION -->
                    <Border Background="#0d0d0d" CornerRadius="8" Padding="15" Margin="0,0,0,15"
                            BorderBrush="#1E5A8E" BorderThickness="1">
                        <StackPanel>
                            <Grid>
                                <TextBlock Text="🎁 ENTITLEMENTS MANAGER" FontSize="16" FontWeight="Bold"
                                         Foreground="#1E5A8E" Margin="0,0,0,10" FontFamily="Consolas"
                                         HorizontalAlignment="Left"
                                         ToolTip="Manage DLC ownership. Add or remove entitlements to unlock/lock content."/>
                                <Button x:Name="AddEntitlementBtn" Content="➕ ADD" 
                                      Width="80" Height="30" 
                                      Background="#1E5A8E" Foreground="White"
                                      FontWeight="Bold" FontSize="11" Cursor="Hand"
                                      Click="AddEntitlement_Click" FontFamily="Consolas"
                                      BorderThickness="0" HorizontalAlignment="Right"
                                      ToolTip="Add a new DLC entitlement"/>
                            </Grid>

                            <!-- Entitlements List -->
                            <Border Background="#000000" CornerRadius="5" Padding="10" Margin="0,10,0,0"
                                    BorderBrush="#333333" BorderThickness="1" MaxHeight="300">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel x:Name="EntitlementsPanel"/>
                                </ScrollViewer>
                            </Border>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>

            <!-- Buttons -->
            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,20,0,0">
                <Button x:Name="ResetToDefaultBtn" Content="🔄 RESET TO DEFAULT" 
                        Width="160" Height="40" Margin="5"
                        Background="#8B0000" Foreground="White"
                        FontWeight="Bold" FontSize="12" Cursor="Hand"
                        Click="ResetToDefault_Click" FontFamily="Consolas"
                        BorderThickness="0"
                        ToolTip="⚠️ Download and restore default configuration from GitHub. This will replace your current config!">
                    <Button.Effect>
                        <DropShadowEffect Color="#8B0000" BlurRadius="10" ShadowDepth="0" Opacity="0.5"/>
                    </Button.Effect>
                </Button>

                <Button x:Name="SaveBtn" Content="💾 SAVE" 
                        Width="120" Height="40" Margin="5"
                        Background="#1E5A8E" Foreground="White"
                        FontWeight="Bold" FontSize="14" Cursor="Hand"
                        Click="SaveBtn_Click" FontFamily="Consolas"
                        BorderThickness="0">
                    <Button.Effect>
                        <DropShadowEffect Color="#1E5A8E" BlurRadius="10" ShadowDepth="0" Opacity="0.5"/>
                    </Button.Effect>
                </Button>

                <Button x:Name="CloseBtn" Content="✕ CLOSE" 
                        Width="120" Height="40" Margin="5"
                        Background="#333333" Foreground="White"
                        FontWeight="Bold" FontSize="14" Cursor="Hand"
                        Click="CloseBtn_Click" FontFamily="Consolas"
                        BorderThickness="0"/>
            </StackPanel>
        </Grid>
    </Border>
</Window>